pop_Change = round(pop_2021.infill - pop_2010),2) %>%
dplyr::select(-county_projection_2021, -county_population_2011,
-proportion_of_county_pop, -pop_2021.infill) %>%
#predict for 2021; only changed pop and lag
mutate(predict_2021.infill = predict(Model6,. , type="response")) # calculate new dist to pop
View(dat_infill_withHighway)
grid.arrange(
dat_infill_withHighway %>%
ggplot() +
geom_point(aes(x=xyC(dat_infill_withHighway)[,1], y=xyC(dat_infill_withHighway)[,2], colour = factor(ntile(pop_Change,5)))) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(dat_infill_withHighway, "pop_Change"),1,8),
name="Population\nChange\nin Quintile\nBreaks") +
geom_sf(data=Pittsburgh_MSA, fill=NA, colour="black", size=1.5) +
geom_sf(data=PittsburghHighways, color='#6c757d', size=1, alpha=0.8) +
geom_sf(data=newHighways, fill=NA, colour="#e5989b", size=1.5) +
labs(title= "Population Change in 2021\nwith Proposed Highway",
subtitle="New highway shown in pink") +
mapTheme(),
dat_infill %>%
ggplot() +
geom_point(aes(x=xyC(dat_infill)[,1], y=xyC(dat_infill)[,2], colour = factor(ntile(pop_Change,5)))) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(dat_infill, "pop_Change"),1,8),
name="Population\nChange\nin Quintile\nBreaks") +
geom_sf(data=Pittsburgh_MSA, fill=NA, colour="black", size=1.5) +
geom_sf(data=PittsburghHighways, color='#6c757d', size=1, alpha=0.8) +
labs(title= "Population Change in 2021\nwithout Proposed Highway",
subtitle=" ") +
mapTheme(), ncol=2
)
grid.arrange( # ADD NEW HIGHWAY
dat_infill_withHighway %>%
ggplot() +
geom_point(aes(x=xyC(dat_infill_withHighway)[,1], y=xyC(dat_infill_withHighway)[,2], colour = factor(ntile(predict_2021.infill,5)))) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(dat_infill_withHighway, "predict_2021.infill"),1,8),
name="Predicted\nProbabilities\nin Quintile\nBreaks") +
geom_sf(data=Pittsburgh_MSA, fill=NA, colour="black", size=1.5) +
geom_sf(data=PittsburghHighways, color='#6c757d', size=1, alpha=0.8) +
geom_sf(data=newHighways, fill=NA, colour="#e5989b", size=1.5) +
labs(title= "Development Potential in 2021\nwith Proposed Highway",
subtitle="(New highway shown in pink)") +
mapTheme(),
dat_infill %>%
ggplot() +
geom_point(aes(x=xyC(dat_infill)[,1], y=xyC(dat_infill)[,2], colour = factor(ntile(predict_2021.infill,5)))) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(dat_infill, "predict_2021.infill"),1,8),
name="Predicted\nProbabilities\nin Quintile\nBreaks") +
geom_sf(data=Pittsburgh_MSA, fill=NA, colour="black", size=1.5) +
geom_sf(data=PittsburghHighways, color='#6c757d', size=1, alpha=0.8) +
labs(title= "Development Potential in 2021\nwithout Proposed Highway",
subtitle=" ") +
mapTheme(), ncol=2
)
dat_infill_withHighway <-
dat11_withHighway %>%
#calculate population change
left_join(countyPopulation_2021_withHighway) %>%
mutate(proportion_of_county_pop = pop_2010 / county_population_2011,
pop_2021.infill = proportion_of_county_pop * new_county_projection_2021,
pop_Change = round(pop_2021.infill - pop_2010),2) %>%
dplyr::select(-county_projection_2021, -county_population_2011,
-proportion_of_county_pop, -pop_2021.infill) %>%
#predict for 2021; only changed pop and lag
mutate(predict_2021.infill = predict(Model6,. , type="response")) # calculate new dist to pop
grid.arrange( # ADD NEW HIGHWAY
dat_infill_withHighway %>%
ggplot() +
geom_point(aes(x=xyC(dat_infill_withHighway)[,1], y=xyC(dat_infill_withHighway)[,2], colour = factor(ntile(predict_2021.infill,5)))) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(dat_infill_withHighway, "predict_2021.infill"),1,8),
name="Predicted\nProbabilities\nin Quintile\nBreaks") +
geom_sf(data=Pittsburgh_MSA, fill=NA, colour="black", size=1.5) +
geom_sf(data=PittsburghHighways, color='#6c757d', size=1, alpha=0.8) +
geom_sf(data=newHighways, fill=NA, colour="#e5989b", size=1.5) +
labs(title= "Development Potential in 2021\nwith Proposed Highway",
subtitle="(New highway shown in pink)") +
mapTheme(),
dat_infill %>%
ggplot() +
geom_point(aes(x=xyC(dat_infill)[,1], y=xyC(dat_infill)[,2], colour = factor(ntile(predict_2021.infill,5)))) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(dat_infill, "predict_2021.infill"),1,8),
name="Predicted\nProbabilities\nin Quintile\nBreaks") +
geom_sf(data=Pittsburgh_MSA, fill=NA, colour="black", size=1.5) +
geom_sf(data=PittsburghHighways, color='#6c757d', size=1, alpha=0.8) +
labs(title= "Development Potential in 2021\nwithout Proposed Highway",
subtitle=" ") +
mapTheme(), ncol=2
)
dat_name <- dat %>%
dplyr::select(NAME)
dat_name_demand <- dat2_demand %>%
st_join(., dat_name)
Allegheny <-
dat_name_demand %>%
filter(NAME == "Allegheny")
Allegheny_landUse <- rbind(
filter(Allegheny, forest_2011 == 1 | wetlands_2011 == 1 ) %>%
dplyr::select() %>% mutate(Land_Use = "Not Suitable"),
filter(Allegheny, developed_2011 == 1) %>%
dplyr::select() %>% mutate(Land_Use = "Developed"))
View(dat2_demand)
rm(dat_name_demand)
dat_name_demand <- dat_infill_withHighway %>%
st_join(., dat_name)
Allegheny <-
dat_name_demand %>%
filter(NAME == "Allegheny")
View(dat_name_demand)
dplyr::mutate(NAME.y = NAME)
if ( any("NAME.y" == colnames(dat_name_demand))) {
dat_name_demand <- dat_name_demand %>%
dplyr::mutate(NAME.y = NAME)
}
Allegheny <-
dat_infill_withHighway %>%
filter(NAME == "Allegheny")
Allegheny_landUse <- rbind(
filter(Allegheny, forest_2011 == 1 | wetlands_2011 == 1 ) %>%
dplyr::select() %>% mutate(Land_Use = "Not Suitable"),
filter(Allegheny, developed_2011 == 1) %>%
dplyr::select() %>% mutate(Land_Use = "Developed"))
View(Allegheny)
Allegheny_landUse <- rbind(
filter(Allegheny, forest_2001 == 1 | wetlands_2001 == 1 ) %>%
dplyr::select() %>% mutate(Land_Use = "Not Suitable"),
filter(Allegheny, developed_2001 == 1) %>%
dplyr::select() %>% mutate(Land_Use = "Developed"))
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#9163cb","#e29578")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#9163cb","#e29578")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
Allegheny <-
dat_infill_withHighway %>%
filter(NAME == "Allegheny") %>%
mutate(Development_Demand = predict_2021.infill)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#9163cb","#e29578")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#9163cb","#e29578")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
ggplot() +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
ggplot() +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1)
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=5) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#9163cb","#e29578")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2))
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=2) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#9163cb","#e29578")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=2) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#9163cb","#e29578")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#543b4b","#FD9235")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#543b4b","#FD9235")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1.5) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#543b4b","#FD9235")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1.5) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#543b4b","#FD9235")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#e5989b", size=1.5) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#543b4b","#FD9235")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), fill="#e5989b", color="#6c757d", size=1.5) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#543b4b","#FD9235")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), fill="#ff5c8a", size=1.5) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#cddafd","#FD9235")) +
labs(title = "Development Potential, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), fill="#ff5c8a", size=1.5) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#cddafd","#FD9235")) +
labs(title = "Projected Population, \n2021: Allegheny") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#ff5c8a", size=1.5) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Development Potential, \n2021: Allegheny",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#ff5c8a", size=1.5) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#FD9235", "#9d8189")) +
labs(title = "Projected Population, \n2021: Allegheny",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#ff5c8a", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Development Potential, \n2021: Allegheny",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#ff5c8a", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#FD9235", "#9d8189")) +
labs(title = "Projected Population, \n2021: Allegheny",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
Washington <-
dat_infill_withHighway %>%
filter(NAME == "Washington") %>%
mutate(Development_Demand = predict_2021.infill)
Washington_landUse <- rbind(
filter(Washington, forest_2011 == 1 | wetlands_2011 == 1 ) %>%
dplyr::select() %>% mutate(Land_Use = "Not Suitable"),
filter(Washington, developed_2011 == 1) %>%
dplyr::select() %>% mutate(Land_Use = "Developed"))
Washington_landUse <- rbind(
filter(Washington, forest_2001 == 1 | wetlands_2001 == 1 ) %>%
dplyr::select() %>% mutate(Land_Use = "Not Suitable"),
filter(Washington, developed_2001 == 1) %>%
dplyr::select() %>% mutate(Land_Use = "Developed"))
Washington <-
dat_infill_withHighway %>%
filter(NAME == "Washington") %>%
mutate(Development_Demand = predict_2021.infill)
Washington_landUse <- rbind(
filter(Washington, forest_2001 == 1 | wetlands_2001 == 1 ) %>%
dplyr::select() %>% mutate(Land_Use = "Not Suitable"),
filter(Washington, developed_2001 == 1) %>%
dplyr::select() %>% mutate(Land_Use = "Developed"))
grid.arrange(
ggplot() +
geom_sf(data=Washington, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Washington_landUse, aes(x=xyC(Washington_landUse)[,1],
y=xyC(Washington_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Washington")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#ff5c8a", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Washington,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Development Potential, \n2021: Washington",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Washington, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Washington_landUse, aes(x=xyC(Washington_landUse)[,1],
y=xyC(Washington_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Washington")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#ff5c8a", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Washington,"pop_Change"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Projected Population, \n2021: Washington",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Washington, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Washington_landUse, aes(x=xyC(Washington_landUse)[,1],
y=xyC(Washington_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Washington")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA)), color="#ff5c8a", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Washington,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Development Potential, \n2021: Washington",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Washington, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Washington_landUse, aes(x=xyC(Washington_landUse)[,1],
y=xyC(Washington_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Washington")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA)), color="#ff5c8a", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Washington,"pop_Change"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Projected Population, \n2021: Washington",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Washington, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Washington_landUse, aes(x=xyC(Washington_landUse)[,1],
y=xyC(Washington_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Washington")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA)), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Washington,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Development Potential, \n2021: Washington",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Washington, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Washington_landUse, aes(x=xyC(Washington_landUse)[,1],
y=xyC(Washington_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Washington")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA)), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Washington,"pop_Change"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Projected Population, \n2021: Washington",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
grid.arrange(
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(Development_Demand,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA)), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Development\nDemand",
labels=substr(quintileBreaks(Allegheny,"Development_Demand"),1,5)) +
scale_colour_manual(values = c("#FD9235", "#9d8189")) +
labs(title = "Development Potential, \n2021: Allegheny",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)),
ggplot() +
geom_sf(data=Allegheny, aes(fill=factor(ntile(pop_Change,5))), colour=NA) +
geom_point(data=Allegheny_landUse, aes(x=xyC(Allegheny_landUse)[,1],
y=xyC(Allegheny_landUse)[,2], colour=Land_Use),
shape = 18, size = 1) +
geom_sf(data=st_intersection(PittsburghHighways,filter(Pittsburgh_MSA, NAME=="Allegheny")), color="#6c757d", size=1) +
geom_sf(data=st_intersection(newHighways,filter(Pittsburgh_MSA)), color="#e5989b", size=1) +
scale_fill_manual(values = palette5, name="Population\nChange",
labels=substr(quintileBreaks(Allegheny,"pop_Change"),1,5)) +
scale_colour_manual(values =c("#FD9235", "#9d8189")) +
labs(title = "Projected Population, \n2021: Allegheny",
subtitle="(New highway shown in pink)") + mapTheme() +
guides(fill = guide_legend(order = 1), colour = guide_legend(order = 2)), ncol=2)
summary(popProject)
